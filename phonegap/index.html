<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Assassin</title>
        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/service.js" ></script>
        <script type="text/javascript" charset="utf-8">
            // wait for device api libraries to load
            document.addEventListener("deviceready", onDeviceReady, false);
            
            // device api's are available
            function onDeviceReady() {
                navigator.geolocation.getCurrentPosition(onSuccess, onError);
            }
            
            // onSuccess Geolocation
            function onSuccess(position) {
                if(typeof(Storage)!=="undefined") {
                    window.localStorage.latitude = position.coords.latitude;
                    window.localStorage.longitude = position.coords.longitude;
                }
                else
                {
                    console.log("Sorry, your browser does not support web storage...");
                }
                                
                var element = document.getElementById('geolocation');
                element.innerHTML = 
                    'Latitude: ' + position.coords.latitude + '<br />' +
                    'Longitude: ' + position.coords.longitude + '<br />' + 
                    'Altitude: ' + position.coords.altitude + '<br />' +
                    'Accuracy: ' + position.coords.accuracy + '<br />' +
                    'Altitude Accuracy: ' + position.coords.altitudeAccuracy + '<br />' +
                    'Heading: ' + position.coords.heading + '<br />' +
                    'Speed: ' + position.coords.speed + '<br />' +
                    'Timestamp: ' + position.timestamp + '<br />';
            }

            // onError Callback receives a PositionError object
            //
            function onError(error) {
                alert('code: '    + error.code    + '\n' +
                      'message: ' + error.message + '\n');
            }
            
            $(document).ready(function() {
                console.log("document ready");
                window.localStorage.clear();
                window.localStorage.longitude = 5;
                window.localStorage.latitude = 10;
                $('#storage').append('blah');
                $('#storage').append(window.localStorage.latitude);
                $('#storage').append(window.localStorage.longitude);
                $('#storage').append('blah');
                $("#btnCallService").click(function() {
                    console.log("btnCallService clicked");
                    event.preventDefault();
                    CallService();
                });
                $("#btnJoinGame").click(function() {
                    console.log("btnJoinGame clicked");
                    event.preventDefault();
                    var name = $('#name').val();
                    var email = $('#email').val();
                    JoinGame(name, email, sessionStorage.latitude, sessionStorage.longitude);
                });
                $("#btnFindNearby").click(function() {
                    console.log("btnFindNearby clicked");
                    event.preventDefault();
                    var email = $('#email').val();
                    FindNearby(email);
                });
                $("#btnUpdateLocation").click(function() {
                    console.log("btnUpdateLocation clicked");
                    event.preventDefault();
                    var email = $('#email').val();
                    var long = parseFloat($('long').val());
                    var lat = parseFloat($('lat').val());
                    UpdateLocation(email, lat, long);
                });
            });
        </script>
    </head>
    
    <body>
        <h1>Assassin Game</h1>
        <p id="geolocation">Finding geolocation...</p>
        <form action="/">
            <input type="text" id="name" placeholder="Name" >
            <br>
            <input type="text" id="email" placeholder="Email" >
            <br>
            <input type="text" id="long" placeholder="long">
            <br>
            <input type="text" id="lat" placeholder="lat">
            
            
            <input type="submit" value="Find Me!" onclick="onDeviceReady" >
            <input id="btnCallService" type="submit" value="Call Service" >
            <input id="btnJoinGame" type="submit" value="Join Game" >
            
            <input id="btnFindNearby" type="submit" value="Find Nearby" >
            
            <input id="btnUpdateLocation" type="submit" value="Update Location">
        </form>
        <div id="result">result area</div>
        <div id="storage">storage</div>
    </body>
    <script type="text/javascript" src="phonegap.js"></script>
</html>